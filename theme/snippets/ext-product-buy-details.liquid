{% comment %} Variables {% endcomment %}
{% if section.settings.replacement_product %}
  {% assign reviews_product = all_products[section.settings.replacement_product] %}
{% else %}
  {% assign reviews_product = product %}
{% endif %}

<script type="text/javascript">
  window.productPageData = window.productPageData || {};
  window.productPageData.faq = [
    {% for i in (1..3) %}
      {% assign question = 'question_' | append: i %}
      {% assign answer = 'answer_' | append: i %}
      {% assign function = 'function_' | append: i %}
      {% assign redirect_url = 'redirect_url_' | append: i %}
      {% if section.settings[answer] != blank or section.settings[redirect_url] != blank %}
        {
          "question": {{ section.settings[question] | json }},
          {% if section.settings[function] == 'slideover' %}
            "answer": {{ section.settings[answer] | json }},
          {% elsif section.settings[function] == 'redirect' %}
            "redirectUrl": {{ section.settings[redirect_url] | json }},
          {% endif %}
        }{% unless forloop.last %},{% endunless %}
      {% endif %}
    {% endfor %}
  ];
</script>

<section id="ext-product-buy-details--{{ section.id }}" class="ext-sections__product-buy-details section bg-cream-500 py-10 md:py-16">
  <div class="flex flex-col space-y-4 lg:space-y-0 md:grid md:grid-cols-10 md:gap-10 wrap px-6 md:px-10">

    <div id="pdp-img-carousel" class="pdp-img-carousel md:col-span-5" data-slides-shown="1"></div>
    <div class="pdp-info md:col-span-5">
      <div class="mb-6">
        {% render 'okendo-reviews-product-rating-summary' with reviews_product as product %}
      </div>

      <h1 class="pdp-title h2 font-header uppercase">{{ product.title }}</h1>
      
      <div class="flex items-center my-6">
        <h4 class="pdp-price h4 flex items-center">
          {% if product.price_varies %}
            {{ product.price_min | money_without_trailing_zeros }}
            -
            {{ product.price_max | money_without_trailing_zeros }}
          {% else %}
            {{ product.price | money_without_trailing_zeros }}
          {% endif %}
        </h4>
        {% if product.metafields['extra_details']['badge'] %}
          <div class="ml-3 inline-flex font-header tracking-widest py-2 px-2 border leading-none border-green-500 rounded-md bg-green-500 uppercase text-white small">{{ product.metafields['extra_details']['badge'] }}</div>
        {% endif %}
      </div>
      
      <div class="pdp-decription text-lg mt-6">
        {{ product.description }}
      </div>
      
      {% if product.metafields['extra_details']['pdp_description_1'] != blank %}
        <div class="pdp-extra-details mt-6">
          <h3 class="font-header mb-1 text-sm tracking-wider font-semibold">WHAT YOU'LL GET:</h3>
          <ul class="list-style list-style--red">
            {% for i in (1..3) %}
              {% assign pdp_description_num = 'pdp_description_' | append: i %}
              {% if product.metafields['extra_details'][pdp_description_num] %}
                <li>{{ product.metafields['extra_details'][pdp_description_num] }}</li>
              {% endif %}
            {% endfor %}
          </ul>
        </div>
      {% endif %}

      <div class="pdp-form-wrapper mt-6">
        {% render 'product-form', 
        product, 
        current_selling_plan_allocation %}
      </div>

      <div id="app-pdp-faq" class="pdp-more-info__faq-list my-8"></div>
    </div>
  </div>
</section>